@page
@model Lesson_11_Razor_Pages.Pages.ChatModel
@using Microsoft.SemanticKernel.ChatCompletion;
@{
    ViewData["Title"] = "ChatBot";
}

<div class="row justify-content-center mt-5">
    <div class="col">
        <div class="card shadow" id="chatContainer" dir="@Model.Direction">
            <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Chat with GPT</h5>
                <form method="post" asp-page-handler="ToggleDirection" class="m-0 p-0">
                    <button type="submit" class="btn btn-light btn-sm">
                        Toggle RTL/LTR
                    </button>
                </form>
            </div>
            <div class="card-body" style="height: 400px; overflow-y: auto;" id="chatArea">
                @if (Model.History.Any())
                {
                    foreach (var msg in Model.History)
                    {
                        if (msg.Role != AuthorRole.System)
                        {
                            <div class="mb-2">
                                <strong>@msg.Role:</strong> @Html.Raw(msg.Content)
                            </div>    
                        }
                        
                    }
                }
                else
                {
                    <div class="text-muted text-center">Start the conversation...</div>
                }
            </div>
            <div class="card-footer">
                <form method="post" asp-page-handler="">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Type your message..." aria-label="Message" name="UserMessage" autocomplete="off" required />
                        <button class="btn btn-primary" type="submit">Send</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


